# Checking the satyr. -*- Autotest -*-

AT_BANNER([Operating system])

## -------------------------------------------- ##
## sr_operating_system_parse_etc_system_release ##
## -------------------------------------------- ##
AT_TESTFUN([sr_operating_system_parse_etc_system_release],
[[
#include "operating_system.h"
#include "utils.h"
#include <stdio.h>
#include <assert.h>

void check(const char *etc_system_release,
           const char *expected_name,
	   const char *expected_version)
{
    printf("Testing %s.\n", etc_system_release);
    char *name, *version;
    bool success = sr_operating_system_parse_etc_system_release(
        etc_system_release,
	&name,
	&version);

    assert(success);
    assert(0 == strcmp(name, expected_name));
    assert(0 == strcmp(version, expected_version));
    free(name);
    free(version);
}

int
main(void)
{
    check("Fedora release 16 (Verne)", "fedora", "16");
    check("Red Hat Enterprise Linux release 6.2", "red hat enterprise linux", "6.2");
    return 0;
}
]])
